{% extends 'layout.html.twig' %}

{% block wrapper %}
{{ parent() }}
<div class="content-wrapper">

  {{ include('JcObdulioBundle:Default:messages/success.html.twig') }}
  {{ include('JcObdulioBundle:Default:messages/danger.html.twig') }}

  <section class="content-header">
    <h1>
      Reportes
      {#<small>it all starts here</small>#}
    </h1>
    <ol class="breadcrumb">
      <li>
        <a href="{{ path('inicio') }}">
          <i class="glyphicon glyphicon-home"></i>
          Inicio</a>
      </li>
      <li>
        <a class="active">Reportes</a>
      </li>
    </ol>
  </section>

  <!-- Main content -->
  <section class="content">

    <!-- Default box -->
    <div class="box">

      <div class="box-header with-border">
        <h4 class="header-title">Seleccione un reporte y las fechas de inicio y fin</h4>

      </div>

      <div class="box-body">

        <form class="form-inline">
          <div class="form-group">
            {{ form_label(form.reporte) }}
            {{ form_errors(form.reporte) }}
            {{ form_widget(form.reporte, { 'attr': {'class': 'form-control input-lg'} }) }}
          </div>
          <div class="form-group">
            {{ form_label(form.fechainicio) }}
            {{ form_errors(form.fechainicio) }}
            {{ form_widget(form.fechainicio, { 'attr': {'class': 'form-control input-lg'} }) }}
          </div>
          <div class="form-group">
            {{ form_label(form.fechafin) }}
            {{ form_errors(form.fechafin) }}
            {{ form_widget(form.fechafin, { 'attr': {'class': 'form-control input-lg'} }) }}
          </div>

          <button type="submit" class="btn btn-primary">Ver Reporte</button>

          <button class="btn btn-info pull-right" type="button" data-toggle="collapse" data-target="#collapseFiltros"
            aria-expanded="false" aria-controls="collapseFiltros">
            Más filtros
          </button>

          <div class="collapse" id="collapseFiltros">
            <div class="well">
              <div class="form-group">
                {{ form_label(form.tipoproducto) }}
                {{ form_errors(form.tipoproducto) }}
                {{ form_widget(form.tipoproducto, { 'attr': {'class': 'form-control input-lg'} }) }}
              </div>
              <div class="form-group">
                {{ form_label(form.unidad) }}
                {{ form_errors(form.unidad) }}
                {{ form_widget(form.unidad, { 'attr': {'class': 'form-control input-lg'} }) }}
              </div>
              <div class="form-group">
                {{ form_label(form.tipounidad) }}
                {{ form_errors(form.tipounidad) }}
                {{ form_widget(form.tipounidad, { 'attr': {'class': 'form-control input-lg'} }) }}
              </div>
            </div>
          </div>

        </form>

      </div>
      <!-- /.box-body -->
    </div>
    <!-- /.box -->

    <!-- Default box -->
    <div class="box">

      <div class="box-header with-border">
        <h2 class="header-title">Reporte de Producción</h2>
      </div>

      <div class="box-body">
        {% switch reporte %}

          {% case "operativo" %}
            {{ include('JcObdulioBundle:Reportes:operativo.html.twig') }}

          {% case "value2" %}
            {{ include('JcObdulioBundle:Reportes:operativo.html.twig') }}

          {% default %}
            {{ include('JcObdulioBundle:Reportes:operativo.html.twig') }}

        {% endswitch %}

      </div>
      <!-- /.box-body -->
    </div>
    <!-- /.box -->

  </section>
  <!-- /.content -->
</div>
{% endblock wrapper %}


{% block javascripts %}
{{ parent() }}
<script src="{{ asset('public/select2/dist/js/select2.min.js') }}"></script>
<script src="{{ asset('public/select2/dist/js/i18n/es.js') }}"></script>
<script src="{{ asset('public/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js') }}"></script>
<script src="{{ asset('public/bootstrap-datepicker/dist/locales/bootstrap-datepicker.es.min.js') }}"></script>
<script src="{{ asset('bundles/rh/js/delete-user.js') }}"></script>
<script src="{{ asset('public/datatables.net/js/jquery.dataTables.min.js') }}"></script>
<script src="{{ asset('public/datatables.net-bs/js/dataTables.bootstrap.min.js') }}"></script>
<script src="{{ asset('public/export/buttons.html5.min.js') }}"></script>
<script src="{{ asset('public/export/buttons.print.min.js') }}"></script>
<script src="{{ asset('public/export/dataTables.buttons.min.js') }}"></script>
<script src="{{ asset('public/export/jszip.min.js') }}"></script>
<script src="{{ asset('public/export/pdfmake.min.js') }}"></script>
<script src="{{ asset('public/export/vfs_fonts.js') }}"></script>
<script src="{{ asset('public/export/buttons.colVis.min.js') }}"></script>

<script>
  $(function () {
    $('#reporte, #tipoproducto, #unidad, #tipounidad').select2();
    $('#fechainicio').datepicker();
    $('#fechafin').datepicker();
    var table = $("#tb_operativos").DataTable({
      paging: true,
      lengthChange: true,
      searching: true,
      ordering: true,
      info: true,
      autoWidth: false,
      dom: 'Blfrtip',
      buttons: [{
          extend: 'copy',
          text: '<i class="fa fa-files-o"></i> Copiar',
          title: 'Reporte operativo',
          exportOptions: {
            columns: [1, 2, 3, 4]
          }
        },
        {
          extend: 'excel',
          text: '<i class="fa fa-file-excel-o"></i> Excel',
          title: 'Reporte operativo',
          exportOptions: {
            columns: [1, 2, 3, 4]
          }
        },
        {
          extend: 'pdf',
          text: '<i class="fa fa-file-pdf-o"></i> PDF',
          title: 'Reporte operativo',
          exportOptions: {
            columns: [1, 2, 3, 4]
          }
        },
        {
          extend: 'print',
          text: '<i class="fa fa-print"></i> Imprimir',
          title: 'Reporte operativo',
          exportOptions: {
            columns: [1, 2, 3, 4]
          }
        }, {
          extend: 'colvis',
          text: '<i class="fa fa-eye"></i> Columnas Visibles'
        }
      ],
      language: {
        buttons: {
          copyTitle: 'Copiado',
          copySuccess: {
            _: '%d filas al portapales',
            1: '1 fila al portapapeles'
          }
        }
      }
    });

    // Apply the search
    table.columns().every(function () {
      var that = this;

      $('input', this.footer()).on('keyup change', function () {
        if (that.search() !== this.value) {
          that.search(this.value).draw();
        }
      });
    });

    $('#tb_operativos tfoot tr').appendTo('#tb_operativos thead');

    $('input:text').attr('style',
      'width: 100%'); // ojo con esto, es importante sino salen muy grandes los search por columnas
    $('.dt-button').removeClass('buttons-html5');
    $('.dt-button').removeClass('buttons-copy');
    $('.dt-button').removeClass('buttons-pdf');
    $('.dt-button').removeClass('buttons-excel');
    $('.dt-button').removeClass('buttons-print');
    $('.dt-button').addClass('btn btn-sm btn-primary');
    $('.dt-button').removeClass('dt-button');
  });
</script>
{% endblock %}

{% block stylesheets %}
{{ parent() }}
<link rel="stylesheet" href="{{ asset('public/datatables.net-bs/css/dataTables.bootstrap.min.css') }}">
<link rel="stylesheet" href="{{ asset('public/export/buttons.dataTables.min.css') }}">
<link rel="stylesheet" href="{{ asset('public/select2/dist/css/select2.min.css') }}">
<link rel="stylesheet" href="{{ asset('public/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css') }}">
<style type="text/css" class="init">
  tfoot input {
    width: 100%;
    padding: 3px;
    box-sizing: border-box;
  }
</style>
{% endblock %}